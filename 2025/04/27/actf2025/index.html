<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Time: 2025.04.26-27 (online) I played XCTF-ACTF 2025 with N0wayBack this weekend, and we got 1st for the first time. My teammates are sooooo strong orz  I with @糖醋小鸡块 solved all 4 crypto challenges. A">
<meta property="og:type" content="article">
<meta property="og:title" content="XCTF-ACTF 2025">
<meta property="og:url" content="http://rechn0.github.io/2025/04/27/actf2025/index.html">
<meta property="og:site_name" content="Rec|rEc|reC">
<meta property="og:description" content="Time: 2025.04.26-27 (online) I played XCTF-ACTF 2025 with N0wayBack this weekend, and we got 1st for the first time. My teammates are sooooo strong orz  I with @糖醋小鸡块 solved all 4 crypto challenges. A">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://rechn0.github.io/2025/04/27/actf2025/images/rank.png">
<meta property="og:image" content="http://rechn0.github.io/2025/04/27/actf2025/images/pvkp.png">
<meta property="article:published_time" content="2025-04-27T07:50:13.000Z">
<meta property="article:modified_time" content="2025-12-25T08:09:19.450Z">
<meta property="article:author" content="rec">
<meta property="article:tag" content="LLL">
<meta property="article:tag" content="FHE">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://rechn0.github.io/2025/04/27/actf2025/images/rank.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/1.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/1.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/1.png">
        
      
    
    <!-- title -->
    <title>XCTF-ACTF 2025</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/links/">Links</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/07/14/codegatectffinal2025/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/04/05/codegatectf2025/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://rechn0.github.io/2025/04/27/actf2025/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://rechn0.github.io/2025/04/27/actf2025/&text=XCTF-ACTF 2025"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rechn0.github.io/2025/04/27/actf2025/&is_video=false&description=XCTF-ACTF 2025"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XCTF-ACTF 2025&body=Check out this article: http://rechn0.github.io/2025/04/27/actf2025/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://rechn0.github.io/2025/04/27/actf2025/&name=XCTF-ACTF 2025&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://rechn0.github.io/2025/04/27/actf2025/&t=XCTF-ACTF 2025"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-log-12-solves"><span class="toc-number">1.</span> <span class="toc-text">easy_log (12 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Our-Solution"><span class="toc-number">1.1.</span> <span class="toc-text">Our Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Additional-Thoughts"><span class="toc-number">1.2.</span> <span class="toc-text">Some Additional Thoughts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AAALLL-8-solves"><span class="toc-number">2.</span> <span class="toc-text">AAALLL (8 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Unintended"><span class="toc-number">2.1.</span> <span class="toc-text">Solution 1 (Unintended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Intended"><span class="toc-number">2.2.</span> <span class="toc-text">Solution 2 (Intended)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OhMyTetration-8-solves"><span class="toc-number">3.</span> <span class="toc-text">OhMyTetration (8 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Fuzzes"><span class="toc-number">3.1.</span> <span class="toc-text">Some Fuzzes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Unintended-1"><span class="toc-number">3.2.</span> <span class="toc-text">Solution 1 (Unintended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Intended-1"><span class="toc-number">3.3.</span> <span class="toc-text">Solution 2 (Intended)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tinyCKKS-2-solves"><span class="toc-number">4.</span> <span class="toc-text">tinyCKKS (2 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CKKS-Intro"><span class="toc-number">4.1.</span> <span class="toc-text">CKKS: Intro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Intended"><span class="toc-number">4.2.</span> <span class="toc-text">Solution 1 (Intended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Unintended"><span class="toc-number">4.3.</span> <span class="toc-text">Solution 2 (Unintended)</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        XCTF-ACTF 2025
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">rec</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-04-27T07:50:13.000Z" class="dt-published" itemprop="datePublished">2025-04-27</time>
        
        (Updated: <time datetime="2025-12-25T08:09:19.450Z" class="dt-updated" itemprop="dateModified">2025-12-25</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/FHE/" rel="tag">FHE</a>, <a class="p-category" href="/tags/LLL/" rel="tag">LLL</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>Time: 2025.04.26-27 (online)</p>
<p>I played XCTF-ACTF 2025 with N0wayBack this weekend, and we got 1st for the first time. My teammates are sooooo strong orz</p>
<p><img src="/2025/04/27/actf2025/images/rank.png" alt="rank.png"></p>
<p>I with @糖醋小鸡块 solved all 4 crypto challenges. All of them are high-quality, and we actually found many interesting unintended solutions XD</p>
<h2 id="easy-log-12-solves"><a href="#easy-log-12-solves" class="headerlink" title="easy_log (12 solves)"></a>easy_log (12 solves)</h2><blockquote>
<ul>
<li><a href="eazy_log/task.py">task.py</a></li>
</ul>
</blockquote>
<p>Yet another DLP challenge. </p>
<h3 id="Our-Solution"><a href="#Our-Solution" class="headerlink" title="Our Solution"></a>Our Solution</h3><p>At first glance this’s a classic curve problem, so we need to recover the curve first. We (@糖醋小鸡块) tried <a target="_blank" rel="noopener" href="https://affine.group/writeup/2024-12-hxp-AlcoholicVariety">an interesting method</a> from @hellman. In this method we take many points as inputs and try to solve the curve parameters by polynomial interpolation. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">R, (x, y) = GF(p)[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>].objgens() <span class="comment"># try on each p, since we need to compute kernel basis</span></span><br><span class="line">xt, yt = <span class="number">2</span>, <span class="number">2</span></span><br><span class="line"></span><br><span class="line">monomials = [x**i*y**j <span class="keyword">for</span> i, j <span class="keyword">in</span> product(<span class="built_in">range</span>(xt+<span class="number">1</span>), <span class="built_in">range</span>(yt+<span class="number">1</span>))]</span><br><span class="line">kG2 = [double_and_add(randint(<span class="number">0</span>, p), G2, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(monomials)+<span class="number">1</span>)]</span><br><span class="line">A = matrix(GF(p), [[monomial(x, y) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials] <span class="keyword">for</span> x, y <span class="keyword">in</span> kG2])</span><br><span class="line">coefs = A.right_kernel().basis()</span><br><span class="line"><span class="keyword">for</span> coef <span class="keyword">in</span> coefs:</span><br><span class="line">	f = <span class="built_in">sum</span>([fi*monomial <span class="keyword">for</span> fi, monomial <span class="keyword">in</span> <span class="built_in">zip</span>(coef, monomials)])</span><br><span class="line">	<span class="built_in">print</span>(coef)</span><br><span class="line">	<span class="built_in">print</span>(f)</span><br></pre></td></tr></table></figure>

<p>And this is a universal method, you just need to pre-assume the monomials. We managed to recover the curve as $x^2 + x \cdot y - y^2 + 1 &#x3D; 0$ with <code>G2</code>, but IT DIDN’T WORK ON <code>G1</code>! (And this will be discussed later)</p>
<p>Now this is a quadratic curve (a conic curve actually), and the order of the curve on $\mathbb{F_p}$ should be $p^2-1$. With some tests, this worked on both <code>G1</code> and <code>G2</code>. Based on this we can implement a PH-BSGS style attack to solve DLP.</p>
<p>For the first part, we factor the given $n$.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">0x231d5fa471913e79facfd95e9b874e2d499def420e0914fab5c9f87e71c2418d1194066bd8376aa8f02ef35c1926f73a46477cd4a88beae89ba575bb3e1b04271426c6706356dd8cd9aa742d7ad0343f8939bfd2110d45122929d29dc022da26551e1ed7000</span></span><br><span class="line">ps = [</span><br><span class="line">    (<span class="number">2</span>, <span class="number">12</span>),</span><br><span class="line">    (<span class="number">5</span>, <span class="number">4</span>),</span><br><span class="line">    (<span class="number">15271784978279</span>, <span class="number">1</span>),</span><br><span class="line">    (<span class="number">10714146599832792643</span>, <span class="number">1</span>), </span><br><span class="line">    (<span class="number">222696442740376752383</span>, <span class="number">3</span>), </span><br><span class="line">    (<span class="number">899889935029682511225429150065010811552017719005924136271659168643090431</span>, <span class="number">1</span>),</span><br><span class="line">    (<span class="number">899889935029682511225429150065010811552017719005924136271659166808024139</span>, <span class="number">1</span>)</span><br><span class="line">]</span><br><span class="line"><span class="keyword">assert</span> n == prod([p**i <span class="keyword">for</span> p, i <span class="keyword">in</span> ps])</span><br></pre></td></tr></table></figure>

<p>It turns out each factor is appropriate for the attack (note that the order on some certain primes are $p-1$). To recover the secret (8*68&#x3D;544bit), we also used p-adic field attack on <code>(222696442740376752383, 3)</code>. Somehow I could only solve it on $p^2$ instead of $p^3$, but that was enough.</p>
<p>For the second part, we just constructed a smooth prime with several 16bit subgroups. </p>
<blockquote>
<p>solution: <a href="eazy_log/exp.py">exp.py</a></p>
</blockquote>
<p>Definitely not a pleasing code, but we have a worse one during the contest.</p>
<h3 id="Some-Additional-Thoughts"><a href="#Some-Additional-Thoughts" class="headerlink" title="Some Additional Thoughts"></a>Some Additional Thoughts</h3><p>So far it’s enough to solve the challenge. We don’t need the curve itself, we just need the order actually. But it’s really weird that <code>G1</code> is not on the curve (not on any curve ig, considering @hellman’s method is universal), but has the same structure.</p>
<p>After the contest I got the answer from @∝: this is not a curve operation but a matrix operation. </p>
<p>$$<br>\begin{bmatrix}<br>y_3-x_3 &amp; x_3 \\<br>x_3 &amp; y_3<br>\end{bmatrix}&#x3D;<br>\begin{bmatrix}<br>y_2-x_2 &amp; x_2 \\<br>x_2 &amp; y_2<br>\end{bmatrix}<br>\cdot<br>\begin{bmatrix}<br>y_1-x_1 &amp; x_1 \\<br>x_1 &amp; y_1<br>\end{bmatrix}<br>$$</p>
<p>This forms a multiplication matrix group. And when the elements satisfy the curve equation, it becomes isomorphic to the addition curve group. But the operation itself doesn’t need the element to be a curve point. And now it’s quite clear. We can analyze the eigenvalues or the group itself to get the order. With the eigenvalues we can also map the elements onto $\mathbb{F_p^2}$, gaining some optimization to solve DLP.</p>
<p>Since this is not my first time to connect matrixs and quadratic curves, I may find some time to give a comprehensive learning these days. And we still need some math works on how to solve such DLP on $p^i$.</p>
<h2 id="AAALLL-8-solves"><a href="#AAALLL-8-solves" class="headerlink" title="AAALLL (8 solves)"></a>AAALLL (8 solves)</h2><blockquote>
<ul>
<li><a href="AAALLL/task.sage">task.sage</a></li>
</ul>
</blockquote>
<p>In this challenge we need to find a $n$-degree small ternary polynomial $f$, with $\frac{n}{2}$ pairs of $(x_i, f(x_i))$ on $\mathbb{F_p}$. The special part is that $x_i$ is randomly picked from the roots of $x^n+1$. Here $n&#x3D;450$ and $pbit&#x3D;32$.</p>
<h3 id="Solution-1-Unintended"><a href="#Solution-1-Unintended" class="headerlink" title="Solution 1 (Unintended)"></a>Solution 1 (Unintended)</h3><p>A direct way is to construct the primal lattice and solve $f$ with <code>flatter</code>. The main reason this worked is $pbit&#x3D;32$ is a little big for $n&#x3D;450$, and it’s enough to solve uSVP under BKZ-2 bound. One can pick a subset of the instances to get a better perfomance.</p>
<h3 id="Solution-2-Intended"><a href="#Solution-2-Intended" class="headerlink" title="Solution 2 (Intended)"></a>Solution 2 (Intended)</h3><p>The intended solution captures the special structure of the lattice. Since $x_i$ is a root of $x^n+1$, we’re actually dealing with a subset of Vandermonde matrix columns. This is called Partial Vandermonde Knapsack Problem, and you can find a optimized solution in <a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/366">this</a> from Eurocrypt 2024.</p>
<p><img src="/2025/04/27/actf2025/images/pvkp.png" alt="pvkp.png"></p>
<p>To make it clear, we have $x^n + 1 &#x3D; 0 \rightarrow \frac{1}{x} &#x3D; -x^{n-1} \pmod{p}$, and this builds certain connections between $f(x)$ and $f(\frac{1}{x})$. For instance, we have $f(x) &#x3D; a_{n-1} \cdot x^{n-1} + …$ and $f(\frac{1}{x}) &#x3D; a_1 \cdot \frac{1}{x} + …$, and we can sum them up to get $f(x) + f(\frac{1}{x}) &#x3D; (a_{n-1}-a_1) \cdot x^{n-1} + …$.</p>
<p>In short, we can construct new polynomials $(\phi_+(x), \phi_-(x))$ with $(f(x), f(\frac{1}{x}))$, where $(\phi_+(x), \phi_-(x))$ are small and can be generated with a shorter (about $\lfloor \frac{n}{2} \rfloor$) basis. The following code gives a better explanation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sample_ternery_poly</span>(<span class="params">Q</span>):</span><br><span class="line">    <span class="keyword">return</span> Q([choice([-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Q.degree())])</span><br><span class="line"></span><br><span class="line">n = <span class="number">450</span></span><br><span class="line">p = <span class="number">3774877201</span></span><br><span class="line">t = n//<span class="number">2</span></span><br><span class="line"></span><br><span class="line">P, x = GF(p)[<span class="string">&quot;x&quot;</span>].objgen()</span><br><span class="line">g = x**n+<span class="number">1</span></span><br><span class="line">roots = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> g.roots()]</span><br><span class="line">Q = P.quotient(g)</span><br><span class="line"></span><br><span class="line">f = sample_ternery_poly(Q).lift()</span><br><span class="line">rs = <span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> roots:</span><br><span class="line">    <span class="keyword">if</span> r <span class="keyword">not</span> <span class="keyword">in</span> rs <span class="keyword">and</span> <span class="number">1</span>/r <span class="keyword">not</span> <span class="keyword">in</span> rs:</span><br><span class="line">        rs.append(r)</span><br><span class="line"></span><br><span class="line">xs = [[r**i + <span class="number">1</span>/r**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">2</span>+<span class="number">1</span>)] <span class="keyword">for</span> r <span class="keyword">in</span> rs]</span><br><span class="line">ys = [f(r) + f(<span class="number">1</span>/r) <span class="keyword">for</span> r <span class="keyword">in</span> rs]</span><br><span class="line"><span class="built_in">print</span>(matrix(GF(p), xs).solve_right(vector(ys)))</span><br><span class="line"></span><br><span class="line">xs = [[r**i - <span class="number">1</span>/r**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n//<span class="number">2</span>+<span class="number">1</span>)] <span class="keyword">for</span> r <span class="keyword">in</span> rs]</span><br><span class="line">ys = [f(r) - f(<span class="number">1</span>/r) <span class="keyword">for</span> r <span class="keyword">in</span> rs]</span><br><span class="line"><span class="built_in">print</span>(matrix(GF(p), xs).solve_right(vector(ys)))</span><br></pre></td></tr></table></figure>

<p>With high possibility, we can find some pairs of $(f(x), f(\frac{1}{x}))$ from the given data. Then we can solve $(\phi_+, \phi_-)$ from two smaller primal lattices and combine them to get the original polynomial $f$. </p>
<h2 id="OhMyTetration-8-solves"><a href="#OhMyTetration-8-solves" class="headerlink" title="OhMyTetration (8 solves)"></a>OhMyTetration (8 solves)</h2><blockquote>
<ul>
<li><a href="OhMyTetration/task.py">task.py</a></li>
</ul>
</blockquote>
<p>Here is a lottery center with some secret code in <code>lotteryCenter</code>. In short, we can send some $(g, times)$ to the server and receive a tetration $\mathcal{T}(p, g, x, times)$. For instance, $\mathcal{T}(p, g, x, 2) &#x3D; g^{g^x} \pmod{p}$. And our target is to recover $x$.</p>
<h3 id="Some-Fuzzes"><a href="#Some-Fuzzes" class="headerlink" title="Some Fuzzes"></a>Some Fuzzes</h3><p>It turns out that each time the server randomly chooses a prime $p$ from a small prime set. Take one of them as an example:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">1502305675703953507826564356364207463785905265358954425050832597353379827611347779894929874274487297076504174110953417469304402049079223143080164648064147459</span></span><br><span class="line">q = (p - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">qs = [(<span class="number">2</span>, <span class="number">12</span>), (<span class="number">2449952539</span>, <span class="number">1</span>), (<span class="number">2580715139</span>, <span class="number">1</span>), (<span class="number">2792523953</span>, <span class="number">1</span>), (<span class="number">2945474351</span>, <span class="number">1</span>), (<span class="number">2996317717</span>, <span class="number">1</span>), (<span class="number">3172879987</span>, <span class="number">1</span>), (<span class="number">3229817321</span>, <span class="number">1</span>), (<span class="number">3272969519</span>, <span class="number">1</span>), (<span class="number">3435471803</span>, <span class="number">1</span>), (<span class="number">3606091481</span>, <span class="number">1</span>), (<span class="number">3613773421</span>, <span class="number">1</span>), (<span class="number">3696075863</span>, <span class="number">1</span>), (<span class="number">3706535681</span>, <span class="number">1</span>), (<span class="number">3729911617</span>, <span class="number">1</span>), (<span class="number">3912962413</span>, <span class="number">1</span>), (<span class="number">3919762169</span>, <span class="number">1</span>)]</span><br><span class="line"><span class="keyword">assert</span> q == prod(qi**i <span class="keyword">for</span> qi, i <span class="keyword">in</span> qs) + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>Here $p &#x3D; 2*q + 1$, where $q$ is another big prime and $q-1$ is very smooth. All other $p$ have the same structure so we can just use this one in the following steps. To achieve that in the code, I just kept reconnecting until the server chose my prime.</p>
<p>Another point worth noting is that we cannot just choose $g$ arbitrarily because of <code>lotteryCenter.defineG(g)</code>. After some tests, we found that some certain primes can pass the check. While it doesn’t expose the underlying checking strategy, we still have the opportunity to get a valid one by keeping constructing some primes.</p>
<h3 id="Solution-1-Unintended-1"><a href="#Solution-1-Unintended-1" class="headerlink" title="Solution 1 (Unintended)"></a>Solution 1 (Unintended)</h3><p>Considering $q-1$ is smooth, with several 32bit small primes, a PH-BSGS style attack works as:</p>
<ol>
<li>Choose a generator $g_i$ from the $q_i$-order subgroup of $\mathbb{F_q}$, here we have $q_i | (q-1)$.</li>
<li>Receive $y &#x3D; \mathcal{T}(p, g_i, x, 2) &#x3D; g_i^{g_i^x} \pmod{p}$ from the server.</li>
<li>For all $a \in [0, t]$, compute and store $g_i^{2 \cdot g^{a \cdot t} \pmod{q}} \pmod{p}$.</li>
<li>For all $b \in [0, t]$, compute $y^{2 \cdot g_i^{-b} \pmod{q}} \pmod{p}$ and query for a corresponding $a$.</li>
<li>Finally, we have $x &#x3D; a \cdot t + b \pmod{q_i}$, and we can combine them using <code>crt</code>.</li>
</ol>
<p>Here we choose $t &#x3D; \lceil \sqrt{q_i} \rceil$ for a balanced perfomance. You can check the correctnest by $y^{g_i^{-b}} &#x3D; g_i^{g_i^{x-b}} &#x3D; g_i^{g_i^{a \cdot t}}\pmod{p}$. The reason we need $g_i^{2 \cdot (…)} \pmod{p}$ instead of $g_i^{(…)} \pmod{p}$ is that the order of $g_i$ may be $p-1 &#x3D; 2 \cdot q$ on $\mathbb{F_p}$, where the order of $g_i^2 \pmod{p}$ is guaranteed to be $q$ (or 1, with negligible probability).</p>
<p>That’s it. What we need to do is to find a valid prime generator $g_i$, get a piece of $x_i$ locally, and then recover $x \pmod{\frac{q-1}{2}}$ with <code>crt</code>. For this chall, we need a little bruteforce to get the real $x &#x3D; (x \pmod{\frac{q-1}{2}}) + k \cdot \frac{q-1}{2}$.</p>
<blockquote>
<ul>
<li>solution: <a href="OhMyTetration/exp.py">exp.py</a></li>
</ul>
</blockquote>
<p>It actually costed us plenty of time since <code>lotteryCenter.defineG(g)</code> is veryyyyy slow, somehow :o</p>
<h3 id="Solution-2-Intended-1"><a href="#Solution-2-Intended-1" class="headerlink" title="Solution 2 (Intended)"></a>Solution 2 (Intended)</h3><p>For the intended solution, we need more complex tetrations. As we compute a “higher” tetration tower, the order decreases rapidly as $\phi(\phi(…\phi(p)))$ where $\phi(x)$ is the Euler function. With an appropriate order, we can bruteforce the solution and a piece of $x$ under some modulus.</p>
<p>This is more complicated. But if the level of tetration got limited or $q-1$ was not that smooth, we might have to try this ig.</p>
<h2 id="tinyCKKS-2-solves"><a href="#tinyCKKS-2-solves" class="headerlink" title="tinyCKKS (2 solves)"></a>tinyCKKS (2 solves)</h2><blockquote>
<ul>
<li><a href="tinyCKKS/main.sage">main.sage</a> # task file</li>
<li><a href="tinyCKKS/ckks.sage">ckks.sage</a> # ckks main class</li>
<li><a href="tinyCKKS/ciphertext.sage">ciphertext.sage</a> # ct class</li>
<li><a href="tinyCKKS/poly.sage">poly.sage</a> # poly class</li>
<li><a href="tinyCKKS/gadget.sage">gadget.sage</a> # ckks gadget function</li>
<li><a href="tinyCKKS/distribution.sage">distribution.sage</a> # ckks distribution function</li>
<li><a href="tinyCKKS/module_test.sage">module_test.sage</a> # module test</li>
</ul>
</blockquote>
<p>A good chance to learn more about FHE-CKKS! Nice code from @den.g_feng :D</p>
<h3 id="CKKS-Intro"><a href="#CKKS-Intro" class="headerlink" title="CKKS: Intro"></a>CKKS: Intro</h3><p>In CKKS we deal with polynomials on a quotient ring with a prime power modulus $q&#x3D;p^i$. At first the modulus is $p^{L+1}$. In general, CKKS is a RLWE style FHE scheme.</p>
<ul>
<li>$\mathcal{Keygen}$: Generate a secret ternary polynomial $sk$.</li>
<li>$\mathcal{Encode}$: For message polynomial $m$, compute $pt_i &#x3D; \lfloor m_i \cdot p \rfloor$ and construct the plaintext polynomial $pt$.</li>
<li>$\mathcal{Decode}$: Compute $m_i &#x3D; \frac{pt_i}{p}$ to recover the original $m$.</li>
<li>$\mathcal{Enc}$: For the plaintext polynomial $pt$, sample a noise polynomial $e$ and a random polynomial $ct_0$. Then compute $ct_1 &#x3D; pt + e - ct_0 \cdot sk$, and the ciphertext pair is $(ct_0, ct_1)$.</li>
<li>$\mathcal{Dec}$ Compute $pt’ &#x3D; ct_1 + ct_0 \cdot sk$.</li>
</ul>
<p>In this challenge we use a simpler encode&#x2F;decode strategy, the original CKKS scheme involves complex number and some other complicated operations.</p>
<p>It’s important to know that CKKS handles float data, which means $m$ is a float sequence (but $pt$ and other parts are not). You can find out that we actually cannot recover the original $pt$ and $m$ in CKKS. The noise is retained and after decoding, it exists as a small error in $m$.</p>
<h3 id="Solution-1-Intended"><a href="#Solution-1-Intended" class="headerlink" title="Solution 1 (Intended)"></a>Solution 1 (Intended)</h3><p>In this challenge our target is to submit the <strong>exact</strong> original <code>plain</code>.</p>
<p>The intended solution uses an interesting feature about CKKS, which may be counter-intuitive to FHE newbies (me). By encoding the decrypted <code>plain</code> again, we can recover the exact $pt + e$, and then we can recover $sk$ with the ciphtext pair $ct$.</p>
<p>I’m not sure about other FHE schemes but for CKKS, it’s <strong>NOT</strong> a secure option to open a decryption oracle. I think the main reason is that CKKS uses floats instead of integers.</p>
<blockquote>
<p>At least in this challenge it’s true. I heard a patched version is available in industrial implementations. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">load(<span class="string">&quot;ckks.sage&quot;</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">1024</span></span><br><span class="line">p = <span class="number">947819</span></span><br><span class="line">B = <span class="number">2</span></span><br><span class="line">L = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">r = <span class="number">10</span></span><br><span class="line">precision = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">debug = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">ckks = tinyCKKS(N, p, B, L, debug)</span><br><span class="line">plain = [<span class="built_in">round</span>(np.random.uniform(<span class="number">0</span>, r), precision) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">pt = ckks.encode(plain)</span><br><span class="line">ct = ckks.encrypt(pt)</span><br><span class="line">pt = ckks.decrypt(ct)</span><br><span class="line">plain = ckks.decode(pt)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recover sk</span></span><br><span class="line">P, z = GF(p)[<span class="string">&quot;z&quot;</span>].objgen()</span><br><span class="line">Q = P.quotient_ring(z**N+<span class="number">1</span>)</span><br><span class="line">pt = ckks.encode(plain)</span><br><span class="line">sk = Q((pt - ct.b).poly.<span class="built_in">list</span>()) / Q(ct.a.poly.<span class="built_in">list</span>())</span><br><span class="line"><span class="keyword">assert</span> P(sk.<span class="built_in">list</span>()) == P(ckks.sk.poly.<span class="built_in">list</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># recover e</span></span><br><span class="line">plain = [<span class="built_in">round</span>(np.random.uniform(<span class="number">0</span>, r), precision) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br><span class="line">pt = ckks.encode(plain)</span><br><span class="line">ct = ckks.encrypt(pt)</span><br><span class="line">e = ct.b + ckks.sk*ct.a - pt</span><br><span class="line">e = [ZZ(_+p//<span class="number">2</span>)%p - p//<span class="number">2</span> <span class="keyword">for</span> _ <span class="keyword">in</span> e.poly.<span class="built_in">list</span>()]</span><br><span class="line"><span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>

<p>Remember our target is to submit the orignial <code>plain</code>, so we need to predict $e$ too. Since the server uses a sequence of consecutive <code>getrandbits(4)</code> to generate $e$, we can crack MT19937 with the current $e$ and predict the next one. And the solution is quite clear now: </p>
<ol>
<li>(<code>c=1</code>) Get any plaintext-ciphertext pair as your wish, recover $sk$.</li>
<li>(<code>c=2</code>) Get a ciphertext and the original <code>plain</code>, use $sk$ to recover $e$.</li>
<li>Recover the underlying MT19937 states and predict the next $e$.</li>
<li>(<code>c=3</code>) Get a ciphertext, use $sk$ and $e$ to recover the orignal <code>plain</code>.</li>
</ol>
<p>It’s worth mentioning that the noise is kinda too small compared to $p$ (you can find it out in <code>module_test</code>, the error between the original <code>plain</code> and the decrypted one is quite small). So it’s also feasible to eliminate the effect of the noise by controlling the precision of the <code>plain</code> (thanks to @hash_hash).</p>
<h3 id="Solution-2-Unintended"><a href="#Solution-2-Unintended" class="headerlink" title="Solution 2 (Unintended)"></a>Solution 2 (Unintended)</h3><p>My teammate @糖醋小鸡块 found an interesting vuln about MT19937. Another PRNG used in this challenge is <code>np.random</code>, which is also based on MT19937 (in certain versions maybe).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># distribution.sage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sample_uniform_poly</span>(<span class="params">Q</span>):</span><br><span class="line">    q = Q.base_ring().cardinality()</span><br><span class="line">    N = Q.degree()</span><br><span class="line">    <span class="keyword">return</span> polynomial(q, N, Q([np.random.choice([-<span class="number">1</span>, <span class="number">1</span>]) * randbelow(<span class="built_in">int</span>(q//<span class="number">2</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Q.degree())]))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sample_ternery_poly</span>(<span class="params">Q</span>):</span><br><span class="line">    q = Q.base_ring().cardinality()</span><br><span class="line">    N = Q.degree()</span><br><span class="line">    <span class="keyword">return</span> polynomial(q, N, Q([np.random.choice([-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Q.degree())]))</span><br><span class="line"></span><br><span class="line"><span class="comment"># main.sage</span></span><br><span class="line">plain = [<span class="built_in">round</span>(np.random.uniform(<span class="number">0</span>, r), precision) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(N)]</span><br></pre></td></tr></table></figure>

<p>While <code>sample_ternery_poly</code> and <code>plain</code> may not be accessible, we can get <code>sample_uniform_poly</code> from <code>ct_0</code> (and somewhere else), and it turns out we can obtain <code>np.random.choice([-1, 1])</code> from the signs of the coefficients. </p>
<p>Only with enough (say 19937bits) consecutive values of <code>np.random.choice([-1, 1])</code> can we recover the underlying states. So instead of <code>ct</code>, we need to use <code>gen_ksk</code> or <code>gen_relin_key</code> which gives <code>t</code> sets of ciphtertext-like data. Here <code>t=100</code> is big so we can get enough data in one shot. Here is how we solved it:</p>
<ol>
<li>(<code>c=1</code> and <code>ccc=3 or 4</code>) Get <code>t</code> sets of <code>sample_uniform_poly</code> data through <code>ksk</code> or <code>galois_key</code> (you can also use <code>relin_key</code> in <code>ccc=2</code>, which may be more complicated to implement). </li>
<li>Recover the underlying MT19937 states and predict the next <code>plain</code> (you can also predict <code>sample_ternery_poly</code> to get the next $e$).</li>
</ol>
<p>We actually thought this is the intended solution since it could use <code>randbelow(q)</code> in <code>sample_uniform_poly</code>. And <code>B</code> is very small to <code>q</code> so <code>t</code> is big enough here, but in <code>module_test</code> we have <code>B=2^8</code>.</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/links/">Links</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-log-12-solves"><span class="toc-number">1.</span> <span class="toc-text">easy_log (12 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Our-Solution"><span class="toc-number">1.1.</span> <span class="toc-text">Our Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Additional-Thoughts"><span class="toc-number">1.2.</span> <span class="toc-text">Some Additional Thoughts</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AAALLL-8-solves"><span class="toc-number">2.</span> <span class="toc-text">AAALLL (8 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Unintended"><span class="toc-number">2.1.</span> <span class="toc-text">Solution 1 (Unintended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Intended"><span class="toc-number">2.2.</span> <span class="toc-text">Solution 2 (Intended)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OhMyTetration-8-solves"><span class="toc-number">3.</span> <span class="toc-text">OhMyTetration (8 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-Fuzzes"><span class="toc-number">3.1.</span> <span class="toc-text">Some Fuzzes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Unintended-1"><span class="toc-number">3.2.</span> <span class="toc-text">Solution 1 (Unintended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Intended-1"><span class="toc-number">3.3.</span> <span class="toc-text">Solution 2 (Intended)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tinyCKKS-2-solves"><span class="toc-number">4.</span> <span class="toc-text">tinyCKKS (2 solves)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CKKS-Intro"><span class="toc-number">4.1.</span> <span class="toc-text">CKKS: Intro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-1-Intended"><span class="toc-number">4.2.</span> <span class="toc-text">Solution 1 (Intended)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Solution-2-Unintended"><span class="toc-number">4.3.</span> <span class="toc-text">Solution 2 (Unintended)</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://rechn0.github.io/2025/04/27/actf2025/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://rechn0.github.io/2025/04/27/actf2025/&text=XCTF-ACTF 2025"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://rechn0.github.io/2025/04/27/actf2025/&is_video=false&description=XCTF-ACTF 2025"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XCTF-ACTF 2025&body=Check out this article: http://rechn0.github.io/2025/04/27/actf2025/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://rechn0.github.io/2025/04/27/actf2025/&title=XCTF-ACTF 2025"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://rechn0.github.io/2025/04/27/actf2025/&name=XCTF-ACTF 2025&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://rechn0.github.io/2025/04/27/actf2025/&t=XCTF-ACTF 2025"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    1984-2026
    rec
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/links/">Links</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8411e09da389ccf9ca0908e876ad4d4d";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
